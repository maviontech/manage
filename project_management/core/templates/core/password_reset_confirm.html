<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Set new password</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600,700&display=swap" rel="stylesheet">
  <style>
    :root{ --card:#fff; --bg:linear-gradient(180deg,#eef6ff 0%,#f4f7fb 100%); --primary:#0b57a4; --accent:#1f86e3; --muted:#6b7280; --danger:#dc2626; --radius:12px; --shadow:0 6px 18px rgba(13,38,63,0.08); }
    *{box-sizing:border-box}
    body{ margin:0; font-family:Inter,system-ui; min-height:100vh; display:flex; align-items:center; justify-content:center; padding:28px; background:var(--bg); color:#0f172a }
    .card{ width:100%; max-width:540px; background:var(--card); padding:26px; border-radius:var(--radius); box-shadow:var(--shadow); border:1px solid rgba(15,23,42,0.04) }
    .brand{ display:flex; gap:12px; align-items:center; margin-bottom:14px }
    .logo{ width:48px; height:48px; border-radius:10px; background:linear-gradient(135deg,var(--primary),var(--accent)); color:white; display:flex; align-items:center; justify-content:center; font-weight:700 }
    h1{ margin:0; font-size:18px } .sub{ margin:4px 0 0; color:var(--muted); font-size:13px }
    label{ display:block; margin-top:12px; font-weight:600}
    input[type="password"]{ width:100%; padding:12px; border-radius:10px; border:1px solid rgba(15,23,42,0.09); font-size:15px }
    .hint{ color:var(--muted); font-size:13px; margin-top:10px }
    .inline-error{ color:var(--danger); font-size:13px; margin-top:8px; display:none }
    button.submit{ margin-top:12px; background:linear-gradient(90deg,var(--primary),var(--accent)); border:none; color:white; padding:10px 14px; border-radius:10px; cursor:pointer; font-weight:600 }
  </style>
</head>
<body>
  <main class="card" role="main" aria-labelledby="reset-title">
    <div class="brand">
      <div class="logo">M</div>
      <div>
        <h1 id="reset-title">Set a new password</h1>
        <p class="sub">Enter a new password for <strong>{{ email }}</strong></p>
      </div>
    </div>

    {% if error %}
      <div style="background:#fff5f5;border-radius:8px;padding:10px;color:var(--danger);margin-bottom:12px">{{ error }}</div>
    {% endif %}
    {% if message %}
      <div style="background:#ecfdf5;border-radius:8px;padding:10px;color:#065f46;margin-bottom:12px">{{ message }}</div>
    {% endif %}

    <form id="reset-form" method="post" novalidate>
      {% csrf_token %}
      <label for="password">New password</label>
      <input id="password" name="password" type="password" required minlength="8" placeholder="New password" />

      <label for="confirm" style="margin-top:10px">Confirm password</label>
      <input id="confirm" name="confirm" type="password" required minlength="8" placeholder="Confirm new password" />

      <div id="pw-error" class="inline-error" role="alert"></div>

      <button type="submit" class="submit">Set password</button>
    </form>
  </main>

  <script>
    (function(){
      const form = document.getElementById('reset-form');
      const pw = document.getElementById('password');
      const confirm = document.getElementById('confirm');
      const err = document.getElementById('pw-error');

      function showError(msg){ err.textContent = msg; err.style.display = msg ? 'block' : 'none'; }

      form.addEventListener('submit', (e) => {
        const a = pw.value || '';
        const b = confirm.value || '';
        if(!a || a.length < 8){ e.preventDefault(); showError('Password must be at least 8 characters.'); pw.focus(); return; }
        if(a !== b){ e.preventDefault(); showError('Passwords do not match.'); confirm.focus(); return; }
        if(/^\s|\s$/.test(a)){ e.preventDefault(); showError('Password cannot start or end with spaces.'); pw.focus(); return; }
        showError('');
      });
    })();
  </script>
</body>
</html>
