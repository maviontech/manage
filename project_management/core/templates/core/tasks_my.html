{% extends "core/base.html" %}
{% load static %}

{% block content %}
<div class="container-fluid py-4">
  <!-- Page Header -->
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h4 class="fw-semibold text-primary">
      <i class="fa-solid fa-clipboard-list me-2"></i> My Tasks
    </h4>
    <div>
      <a href="{% url 'create_task' %}" class="btn btn-sm btn-outline-primary me-2">
        <i class="fa-solid fa-plus"></i> New Task
      </a>
      <a href="{% url 'task_board' %}" class="btn btn-sm btn-primary">
        <i class="fa-solid fa-th-large"></i> Task Board
      </a>
    </div>
  </div>

  <!-- Task Table -->
  <div class="card shadow-sm border-0">
    <div class="card-body p-0">
      {% if tasks %}
      <div class="table-responsive">
        <table class="table table-hover align-middle mb-0">
          <thead class="table-light">
            <tr>
              <th style="width:5%">#</th>
              <th style="width:30%">Title</th>
              <th style="width:15%">Priority</th>
              <th style="width:15%">Status</th>
              <th style="width:15%">Due Date</th>
              <th style="width:20%" class="text-end">Actions</th>
            </tr>
          </thead>
          <tbody>
            {% for t in tasks %}
            <tr class="hover-highlight">
              <td class="text-muted small">{{ forloop.counter }}</td>
              <td>
                <div class="fw-semibold">{{ t.title }}</div>
                <div class="text-muted small">Task ID: {{ t.id }}</div>
              </td>
              <td>
                {% if t.priority == "Critical" %}
                  <span class="badge bg-danger">{{ t.priority }}</span>
                {% elif t.priority == "High" %}
                  <span class="badge bg-warning text-dark">{{ t.priority }}</span>
                {% elif t.priority == "Low" %}
                  <span class="badge bg-secondary">{{ t.priority }}</span>
                {% else %}
                  <span class="badge bg-info text-dark">{{ t.priority }}</span>
                {% endif %}
              </td>
              <td>
                {% if t.status == "Closed" %}
                  <span class="badge bg-success"><i class="fa-solid fa-check"></i> {{ t.status }}</span>
                {% elif t.status == "In Progress" %}
                  <span class="badge bg-primary"><i class="fa-solid fa-spinner fa-spin"></i> {{ t.status }}</span>
                {% elif t.status == "Blocked" %}
                  <span class="badge bg-dark"><i class="fa-solid fa-ban"></i> {{ t.status }}</span>
                {% elif t.status == "Review" %}
                  <span class="badge bg-warning text-dark"><i class="fa-solid fa-eye"></i> {{ t.status }}</span>
                {% else %}
                  <span class="badge bg-secondary"><i class="fa-solid fa-hourglass-start"></i> {{ t.status }}</span>
                {% endif %}
              </td>
              <td>
                {% if t.due_date %}
                  {% if t.due_date < today %}
                    <span class="text-danger fw-semibold"><i class="fa-solid fa-clock"></i> {{ t.due_date }}</span>
                  {% else %}
                    <span class="text-muted">{{ t.due_date }}</span>
                  {% endif %}
                {% else %}
                  <span class="text-muted">â€”</span>
                {% endif %}
              </td>
              <td class="text-end">
                <a href="#" class="btn btn-sm btn-light border"><i class="fa-solid fa-eye"></i></a>
                <a href="#" class="btn btn-sm btn-light border"><i class="fa-solid fa-pen"></i></a>
                <a href="#" class="btn btn-sm btn-light border text-danger"><i class="fa-solid fa-trash"></i></a>
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
      {% else %}
      <div class="text-center p-5 text-muted">
        <i class="fa-solid fa-circle-info fa-2x mb-3 d-block"></i>
        No tasks assigned to you yet.
      </div>
      {% endif %}
    </div>
  </div>
</div>

<style>
/* Custom Table Styling */
.table-hover tbody tr:hover {
  background-color: rgba(56,189,248,0.05);
}
.hover-highlight td {
  transition: background-color 0.3s ease;
}
.badge {
  font-size: 0.8rem;
  padding: 0.4em 0.65em;
  border-radius: 0.5rem;
}
.btn-sm i {
  font-size: 0.85rem;
}
</style>
{% endblock %}
