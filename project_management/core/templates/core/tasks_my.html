{% extends "core/base.html" %}
{% load static %}

{% block content %}
<div class="container-fluid py-4">

  <!-- HEADER -->
  <div class="d-flex justify-content-between align-items-center mb-4">
    <div>
      <h4 class="fw-bold mb-1 text-gradient">
        <i class="fa-solid fa-clipboard-list me-2"></i> My Tasks
      </h4>
      <p class="text-muted small mb-0">View, track and manage your assigned work items.</p>
    </div>
    <div>
      <a href="{% url 'create_task' %}" class="btn btn-gradient me-2">
        <i class="fa-solid fa-plus"></i> New Task
      </a>
      <a href="{% url 'task_board' %}" class="btn btn-outline-gradient">
        <i class="fa-solid fa-th-large"></i> Board View
      </a>
    </div>
  </div>

  <!-- TABLE CARD -->
  <div class="card soft-card">
    <div class="card-body p-0">
      {% if tasks %}
      <div class="table-responsive">
        <table class="table align-middle mb-0 table-hover modern-table">
          <thead>
            <tr>
              <th>#</th>
              <th>Title</th>
              <th>Priority</th>
              <th>Status</th>
              <th>Due</th>
              <th class="text-end">Actions</th>
            </tr>
          </thead>
          <tbody>
            {% for t in tasks %}
            <tr>
              <td class="text-muted small">{{ forloop.counter }}</td>
              <td>
                <div class="fw-semibold text-truncate">{{ t.title }}</div>
                <small class="text-muted">#{{ t.id }}</small>
              </td>
              <td>
                <span class="badge priority {{ t.priority|lower }}">{{ t.priority }}</span>
              </td>
              <td>
                <span class="badge status {{ t.status|slugify }}">
                  <i class="fa-solid fa-circle me-1"></i> {{ t.status }}
                </span>
              </td>
              <td>
                {% if t.due_date %}
                  <span class="{% if t.due_date < today %}text-danger fw-semibold{% else %}text-muted{% endif %}">
                    <i class="fa-regular fa-clock me-1"></i>{{ t.due_date }}
                  </span>
                {% else %}
                  <span class="text-muted">â€”</span>
                {% endif %}
              </td>
              <td class="text-end">
                <a href="{% url 'task_detail' t.id %}" class="btn btn-sm btn-light action-btn" title="View"><i class="fa-solid fa-eye"></i></a>
                <a href="{% url 'task_edit' t.id %}" class="btn btn-sm btn-light action-btn" title="Edit"><i class="fa-solid fa-pen"></i></a>
                <button class="btn btn-sm btn-light action-btn text-danger" title="Delete"><i class="fa-solid fa-trash"></i></button>
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
      {% else %}
      <div class="p-5 text-center text-muted">
        <i class="fa-regular fa-circle-check fa-2x mb-3"></i><br>
        You have no assigned tasks.
      </div>
      {% endif %}
    </div>
  </div>
</div>

<style>
/* Visual tokens */
.text-gradient { background: linear-gradient(90deg,#0b57a4,#38bdf8); -webkit-background-clip:text; color:transparent; }
.btn-gradient { background: linear-gradient(90deg,#0b57a4,#1f86e3,#38bdf8); color:#fff; border:none; border-radius:8px; padding:8px 14px; }
.btn-outline-gradient { border:1px solid #38bdf8; color:#0b57a4; border-radius:8px; padding:6px 12px; }
.soft-card { border-radius:12px; box-shadow:0 6px 18px rgba(13,38,71,0.06); border:none; }
.modern-table thead { background: linear-gradient(90deg, rgba(11,87,164,0.06), rgba(31,134,227,0.04)); color:#0b57a4; font-weight:600; }
.priority.low { background:#adb5bd; color:#fff; } .priority.normal { background:#0dcaf0; color:#00303f; } .priority.high { background:#ffc107; color:#1f1f1f; } .priority.critical { background:#dc3545; color:#fff; }
.status.closed { background:#198754; color:#fff; } .status.blocked { background:#212529; color:#fff; } .status.review { background:#ffc107; } .status.in-progress { background:#0b57a4; color:#fff; }
.action-btn { border-radius:8px; border:1px solid rgba(0,0,0,0.04); }
</style>
{% endblock %}
